<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c2{background-color:#1e1e1e;padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c7{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c8{font-size:9pt;font-family:"Courier New";color:#b5cea8;font-weight:400}.c0{font-size:9pt;font-family:"Courier New";color:#dcdcaa;font-weight:400}.c3{font-size:9pt;font-family:"Courier New";color:#569cd6;font-weight:400}.c9{font-size:9pt;font-family:"Courier New";color:#808080;font-weight:400}.c4{font-size:9pt;font-family:"Courier New";color:#c586c0;font-weight:400}.c1{font-size:9pt;font-family:"Courier New";color:#d4d4d4;font-weight:400}.c10{font-size:9pt;font-family:"Courier New";color:#ce9178;font-weight:400}.c14{font-size:9pt;font-family:"Courier New";color:#4ec9b0;font-weight:400}.c11{font-size:9pt;font-family:"Courier New";color:#9cdcfe;font-weight:400}.c16{color:#000000;font-size:11pt;font-family:"Arial"}.c17{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c6{text-decoration:none;vertical-align:baseline;font-style:normal}.c12{height:11pt}.c15{font-weight:700}.c13{margin-left:36pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c17"><p class="c7"><span class="c5">Up until now, we have used data that is written directly into the code as a variable. In this short module, you will load an external json file into your code and create charts out of its data.</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c16 c6 c15">Setup - step 0</span></p><p class="c7"><span class="c5">We will have the same anscombe data, but this time as 2 different types of data files.</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7 c13"><span class="c15">Index.html </span><span class="c5">- this is where the structure of our webpage will live.</span></p><p class="c7 c12 c13"><span class="c5"></span></p><p class="c7 c13"><span class="c15">D3.js - </span><span class="c5">&nbsp;this is the d3 library&rsquo;s contents. We will not be altering this file at all. We will link this this file to our html file so that we can access its contents and use d3.js methods.</span></p><p class="c7 c12 c13"><span class="c5"></span></p><p class="c7 c13"><span class="c15">external.js - </span><span>This is the file you will write your javascript code in. It is linked to your index.html file in the same way as the d3.js library file. </span><span class="c16 c6 c15">&nbsp;This file is blank to start.</span></p><p class="c7 c12"><span class="c6 c15 c16"></span></p><p class="c7 c13"><span class="c15">anscombe.json - </span><span class="c5">this is a javascript object notation format of anscombe data</span></p><p class="c7 c12 c13"><span class="c5"></span></p><p class="c7 c12 c13"><span class="c5"></span></p><p class="c7"><span class="c5">As in Module 2 and 3, we will link both d3.js and external.js to our index.html file.</span></p><p class="c2"><span class="c9">&lt;!</span><span class="c3">DOCTYPE</span><span class="c1">&nbsp;</span><span class="c11">html</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;</span><span class="c3">meta</span><span class="c1">&nbsp;</span><span class="c11">charset</span><span class="c1">=</span><span class="c10">&quot;utf-8&quot;</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;</span><span class="c3">html</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;</span><span class="c3">head</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c9">&lt;</span><span class="c3">script</span><span class="c1">&nbsp;</span><span class="c11">src</span><span class="c1">=</span><span class="c10">&quot;d3.js&quot;</span><span class="c9">&gt;&lt;/</span><span class="c3">script</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;/</span><span class="c3">head</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;</span><span class="c3">body</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c9">&lt;</span><span class="c3">script</span><span class="c1">&nbsp;</span><span class="c11">src</span><span class="c1">=</span><span class="c10">&quot;external.js&quot;</span><span class="c9">&gt;&lt;/</span><span class="c3">script</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;/</span><span class="c3">body</span><span class="c9 c6">&gt;</span></p><p class="c2"><span class="c9">&lt;/</span><span class="c3">html</span><span class="c9 c6">&gt;</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c16 c6 c15">Loading data</span></p><p class="c7"><span class="c5">D3 has built in functionality to parse different data formats. Json is among the most common so we will use it as an example.</span></p><p class="c7"><span class="c5">To have d3 read a json file:</span></p><p class="c2"><span class="c3">var</span><span class="c1">&nbsp;</span><span class="c11">jsonData</span><span class="c1">&nbsp;= </span><span class="c11">d3</span><span class="c1">.</span><span class="c0">json</span><span class="c1">(</span><span class="c10">&quot;anscombe.json&quot;</span><span class="c1 c6">)</span></p><p class="c7"><span class="c5">Next we must load the parsed file into our browser memory so that we can draw with the data. And we must only start drawing after the files have been loaded.</span></p><p class="c2"><span class="c14">Promise</span><span class="c1">.</span><span class="c0">all</span><span class="c1">([</span><span class="c11">all</span><span class="c1">&nbsp;</span><span class="c11">your</span><span class="c1">&nbsp;</span><span class="c11">files</span><span class="c1">&nbsp;</span><span class="c11">will</span><span class="c1">&nbsp;</span><span class="c11">go</span><span class="c1">&nbsp;</span><span class="c11">here</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">.</span><span class="c0">then</span><span class="c1">(</span><span class="c3">function</span><span class="c1">(</span><span class="c11">data</span><span class="c1 c6">){</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">all</span><span class="c1">&nbsp;</span><span class="c11">your</span><span class="c1">&nbsp;</span><span class="c11">code</span><span class="c1">&nbsp;</span><span class="c11">that</span><span class="c1">&nbsp;</span><span class="c11">uses</span><span class="c1">&nbsp;</span><span class="c11">the</span><span class="c1">&nbsp;</span><span class="c11">files</span><span class="c1">&nbsp;</span><span class="c11">will</span><span class="c1">&nbsp;</span><span class="c11">go</span><span class="c1">&nbsp;</span><span class="c11">here</span><span class="c1 c6">&nbsp; &nbsp;</span></p><p class="c2"><span class="c1 c6">})</span></p><p class="c7"><span class="c5">Promises takes an array as input, and when the files are loaded, .then springs into action to perform the code you have written that addresses the array.</span></p><p class="c7"><span class="c5">For us, we will load the parsed .json so our code looks like this.</span></p><p class="c2"><span class="c14">Promise</span><span class="c1">.</span><span class="c0">all</span><span class="c1">([</span><span class="c11">jsonData</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">.</span><span class="c0">then</span><span class="c1">(</span><span class="c3">function</span><span class="c1">(</span><span class="c11">data</span><span class="c1 c6">){</span></p><p class="c2 c12"><span class="c1 c6"></span></p><p class="c2"><span class="c1 c6">})</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c5">Let&rsquo;s check what we have loaded by logging the data out in our console.</span></p><p class="c2"><span class="c14">Promise</span><span class="c1">.</span><span class="c0">all</span><span class="c1">([</span><span class="c11">jsonData</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">.</span><span class="c0">then</span><span class="c1">(</span><span class="c3">function</span><span class="c1">(</span><span class="c11">data</span><span class="c1 c6">){</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">console</span><span class="c1">.</span><span class="c0">log</span><span class="c1">(</span><span class="c11">data</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1 c6">})</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c5">Under console in our devTools window, we should see the data being printed out. The data is nested inside an array. This is useful for when we load more than 1 dataset. Since there is only 1 item in our array, to get to the data, we simply use data[0] to access the first item in the array.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 21.33px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 21.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c5">Take a closer look at the json by expanding it in the console.</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 157.33px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 157.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c5">This format should be familiar to us, set 1 - 4 are here as they were when directly written into the .js file &nbsp;To get the values inside set1, we would use &ldquo;set1&rdquo; as a key data[0][&ldquo;set1&rdquo;].</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c5">Let&rsquo;s try drawing it with a preexisting function.</span></p><p class="c2 c12"><span class="c5"></span></p><p class="c2"><span class="c3">function</span><span class="c1">&nbsp;</span><span class="c0">scatterPlot</span><span class="c1">(</span><span class="c11">inputDataset</span><span class="c1 c6">){</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c3">var</span><span class="c1">&nbsp;</span><span class="c11">svg</span><span class="c1">&nbsp;= </span><span class="c11">d3</span><span class="c1">.</span><span class="c0">select</span><span class="c1">(</span><span class="c10">&quot;body&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">append</span><span class="c1">(</span><span class="c10">&quot;svg&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;width&quot;</span><span class="c1">,</span><span class="c8">400</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;height&quot;</span><span class="c1">,</span><span class="c8">400</span><span class="c1 c6">)</span></p><p class="c2 c12"><span class="c1 c6"></span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c3">var</span><span class="c1">&nbsp;</span><span class="c11">xScale</span><span class="c1">&nbsp;= </span><span class="c11">d3</span><span class="c1">.</span><span class="c0">scaleLinear</span><span class="c1 c6">()</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">domain</span><span class="c1">([</span><span class="c8">0</span><span class="c1">,</span><span class="c8">20</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">range</span><span class="c1">([</span><span class="c8">0</span><span class="c1">,</span><span class="c8">300</span><span class="c1 c6">])</span></p><p class="c2 c12"><span class="c1 c6"></span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c3">var</span><span class="c1">&nbsp;</span><span class="c11">yScale</span><span class="c1">&nbsp;= </span><span class="c11">d3</span><span class="c1">.</span><span class="c0">scaleLinear</span><span class="c1 c6">()</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">domain</span><span class="c1">([</span><span class="c8">0</span><span class="c1">,</span><span class="c8">20</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">range</span><span class="c1">([</span><span class="c8">300</span><span class="c1">,</span><span class="c8">0</span><span class="c1 c6">])</span></p><p class="c2 c12"><span class="c1 c6"></span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">svg</span><span class="c1">.</span><span class="c0">selectAll</span><span class="c1">(</span><span class="c10">&quot;circle&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">data</span><span class="c1">(</span><span class="c11">inputDataset</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">enter</span><span class="c1 c6">()</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">append</span><span class="c1">(</span><span class="c10">&quot;circle&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;r&quot;</span><span class="c1">,</span><span class="c8">5</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;cx&quot;</span><span class="c1">,</span><span class="c3">function</span><span class="c1">(</span><span class="c11">d</span><span class="c1 c6">){</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">return</span><span class="c1">&nbsp;</span><span class="c0">xScale</span><span class="c1">(</span><span class="c11">d</span><span class="c1">.</span><span class="c11">x</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1 c6">&nbsp; &nbsp;})</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;cy&quot;</span><span class="c1">,</span><span class="c3">function</span><span class="c1">(</span><span class="c11">d</span><span class="c1 c6">){</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">return</span><span class="c1">&nbsp;</span><span class="c0">yScale</span><span class="c1">(</span><span class="c11">d</span><span class="c1">.</span><span class="c11">y</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1 c6">&nbsp; &nbsp;})</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;.</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;transform&quot;</span><span class="c1">,</span><span class="c10">&quot;translate(30,30)&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c3">var</span><span class="c1">&nbsp;</span><span class="c11">xAxis</span><span class="c1">&nbsp;= </span><span class="c11">d3</span><span class="c1">.</span><span class="c0">axisBottom</span><span class="c1">().</span><span class="c0">scale</span><span class="c1">(</span><span class="c11">xScale</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c3">var</span><span class="c1">&nbsp;</span><span class="c11">yAxis</span><span class="c1">&nbsp;= </span><span class="c11">d3</span><span class="c1">.</span><span class="c0">axisLeft</span><span class="c1">().</span><span class="c0">scale</span><span class="c1">(</span><span class="c11">yScale</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">svg</span><span class="c1">.</span><span class="c0">append</span><span class="c1">(</span><span class="c10">&quot;g&quot;</span><span class="c1">).</span><span class="c0">call</span><span class="c1">(</span><span class="c11">xAxis</span><span class="c1">).</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;transform&quot;</span><span class="c1">,</span><span class="c10">&quot;translate(30,330)&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">svg</span><span class="c1">.</span><span class="c0">append</span><span class="c1">(</span><span class="c10">&quot;g&quot;</span><span class="c1">).</span><span class="c0">call</span><span class="c1">(</span><span class="c11">yAxis</span><span class="c1">).</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;transform&quot;</span><span class="c1">,</span><span class="c10">&quot;translate(30,30)&quot;</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">svg</span><span class="c1">.</span><span class="c0">append</span><span class="c1">(</span><span class="c10">&quot;text&quot;</span><span class="c1">).</span><span class="c0">text</span><span class="c1">(</span><span class="c10">&quot;x&quot;</span><span class="c1">).</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;x&quot;</span><span class="c1">,</span><span class="c8">160</span><span class="c1">).</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;y&quot;</span><span class="c1">,</span><span class="c8">360</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">svg</span><span class="c1">.</span><span class="c0">append</span><span class="c1">(</span><span class="c10">&quot;text&quot;</span><span class="c1">).</span><span class="c0">text</span><span class="c1">(</span><span class="c10">&quot;y&quot;</span><span class="c1">).</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;x&quot;</span><span class="c1">,</span><span class="c8">0</span><span class="c1">).</span><span class="c0">attr</span><span class="c1">(</span><span class="c10">&quot;y&quot;</span><span class="c1">,</span><span class="c8">160</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1 c6">}</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span>And call it with the data we just loaded.</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c0">scatterPlot</span><span class="c1">(</span><span class="c11">data</span><span class="c1">[</span><span class="c8">0</span><span class="c1">][</span><span class="c10">&quot;set1&quot;</span><span class="c1 c6">])</span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7"><span class="c5">We must make this call within the context of the loaded data, within the .then section of the code.</span></p><p class="c2"><span class="c14">Promise</span><span class="c1">.</span><span class="c0">all</span><span class="c1">([</span><span class="c11">jsonData</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">.</span><span class="c0">then</span><span class="c1">(</span><span class="c3">function</span><span class="c1">(</span><span class="c11">data</span><span class="c1 c6">){</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c11">console</span><span class="c1">.</span><span class="c0">log</span><span class="c1">(</span><span class="c11">data</span><span class="c1 c6">)</span></p><p class="c2"><span class="c1">&nbsp; &nbsp;</span><span class="c0">scatterPlot</span><span class="c1">(</span><span class="c11">data</span><span class="c1">[</span><span class="c8">0</span><span class="c1">][</span><span class="c10">&quot;set1&quot;</span><span class="c1 c6">])</span></p><p class="c2"><span class="c1">})</span></p><p class="c7"><span class="c5">Here is our scatterplot again, drawn with the same function, but using a external data file.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 322.30px; height: 328.50px;"><img alt="" src="images/image2.png" style="width: 322.30px; height: 328.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7 c12"><span class="c5"></span></p><p class="c7 c12"><span class="c5"></span></p></body></html>